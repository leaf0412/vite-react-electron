# Electron é¡¹ç›®é‡æ„æŒ‡å—

## ğŸ¯ é‡æ„ç›®æ ‡

å°†ç°æœ‰å¤æ‚çš„ç›®å½•ç»“æ„é‡æ„ä¸ºç®€å•ã€å®ç”¨çš„æ¶æ„ï¼Œä¸“ä¸º 3~5 äººå›¢é˜Ÿè®¾è®¡ã€‚

## ğŸ“ æ–°çš„ç›®å½•ç»“æ„

```
src/main/
â”œâ”€â”€ main.ts                     # åº”ç”¨å…¥å£
â”œâ”€â”€ core/                       # æ ¸å¿ƒåŸºç¡€è®¾æ–½
â”‚   â”œâ”€â”€ app.ts                 # åº”ç”¨ç®¡ç†å™¨
â”‚   â”œâ”€â”€ ipc-manager.ts         # IPC ç®¡ç†å™¨
â”‚   â””â”€â”€ logger.ts              # æ—¥å¿—ç³»ç»Ÿ
â”œâ”€â”€ features/                   # åŠŸèƒ½æ¨¡å—
â”‚   â”œâ”€â”€ file/                  # æ–‡ä»¶ç®¡ç† âœ… å·²å®Œæˆ
â”‚   â”‚   â”œâ”€â”€ service.ts         # ä¸šåŠ¡é€»è¾‘ (~130 è¡Œ)
â”‚   â”‚   â”œâ”€â”€ ipc.ts             # IPC å¤„ç† (~80 è¡Œ)
â”‚   â”‚   â””â”€â”€ index.ts           # å¯¼å‡º (~8 è¡Œ)
â”‚   â”œâ”€â”€ window/                # çª—å£ç®¡ç† (å¾…è¿ç§»)
â”‚   â”œâ”€â”€ dialog/                # å¯¹è¯æ¡† (å¾…è¿ç§»)
â”‚   â”œâ”€â”€ network/               # ç½‘ç»œåŠŸèƒ½ (å¾…è¿ç§»)
â”‚   â””â”€â”€ system/                # ç³»ç»ŸåŠŸèƒ½ (å¾…è¿ç§»)
â”œâ”€â”€ shared/                     # å…±äº«èµ„æº âœ… å·²å®Œæˆ
â”‚   â”œâ”€â”€ constants.ts           # äº‹ä»¶å’Œå¸¸é‡å®šä¹‰
â”‚   â”œâ”€â”€ types.ts               # ç±»å‹å®šä¹‰
â”‚   â”œâ”€â”€ utils.ts               # å·¥å…·å‡½æ•°
â”‚   â””â”€â”€ index.ts               # ç»Ÿä¸€å¯¼å‡º
â””â”€â”€ protocols/                  # åè®®æ³¨å†Œ (å¯é€‰)
```

// å½“ file/service.ts è¶…è¿‡ 300 è¡Œæ—¶çš„æ‹†åˆ†æ–¹æ¡ˆ
file/
â”œâ”€â”€ service.ts           # ä¸»æœåŠ¡ç±» (~150 è¡Œ)
â”œâ”€â”€ operations/          # æ“ä½œç»†åˆ†
â”‚   â”œâ”€â”€ read.ts         # è¯»å–æ“ä½œ (~100 è¡Œ)
â”‚   â”œâ”€â”€ write.ts        # å†™å…¥æ“ä½œ (~100 è¡Œ)
â”‚   â”œâ”€â”€ directory.ts    # ç›®å½•æ“ä½œ (~100 è¡Œ)
â”‚   â””â”€â”€ permissions.ts  # æƒé™æ“ä½œ (~80 è¡Œ)
â”œâ”€â”€ ipc.ts              # IPC å¤„ç† (~120 è¡Œ)
â””â”€â”€ index.ts            # å¯¼å‡º


## ğŸš€ å·²å®Œæˆçš„å·¥ä½œ

### 1. å…±äº«åŸºç¡€è®¾æ–½
- âœ… `shared/constants.ts` - ç»Ÿä¸€çš„äº‹ä»¶å®šä¹‰å’Œå¸¸é‡
- âœ… `shared/types.ts` - é€šç”¨ç±»å‹å®šä¹‰
- âœ… `shared/utils.ts` - å·¥å…·å‡½æ•°
- âœ… `shared/index.ts` - ç»Ÿä¸€å¯¼å‡º

### 2. æ ¸å¿ƒåŸºç¡€è®¾æ–½
- âœ… `core/logger.ts` - ç®€åŒ–çš„æ—¥å¿—ç³»ç»Ÿ
- âœ… `core/ipc-manager.ts` - IPC ç®¡ç†å™¨
- âœ… `core/app.ts` - åº”ç”¨ç®¡ç†å™¨

### 3. æ–‡ä»¶æ¨¡å— (ç¤ºä¾‹)
- âœ… `features/file/service.ts` - æ–‡ä»¶æ“ä½œä¸šåŠ¡é€»è¾‘
- âœ… `features/file/ipc.ts` - æ–‡ä»¶æ“ä½œ IPC å¤„ç†
- âœ… `features/file/index.ts` - æ¨¡å—å¯¼å‡º

## ğŸ“‹ ä¸‹ä¸€æ­¥è¿ç§»è®¡åˆ’

### è¿ç§»ä¼˜å…ˆçº§

1. **Window æ¨¡å—** (ä¼˜å…ˆçº§ï¼šé«˜)
   - ä» `src/main/core/window/` è¿ç§»åˆ° `src/main/features/window/`
   - è´Ÿè´£äººï¼šå‰ç«¯å¼€å‘è€…

2. **Dialog æ¨¡å—** (ä¼˜å…ˆçº§ï¼šé«˜)
   - ä» `src/main/services/dialog/` è¿ç§»åˆ° `src/main/features/dialog/`
   - è´Ÿè´£äººï¼šå‰ç«¯å¼€å‘è€…

3. **Network æ¨¡å—** (ä¼˜å…ˆçº§ï¼šä¸­)
   - åˆå¹¶ `websocket` å’Œ `udp` åˆ° `src/main/features/network/`
   - è´Ÿè´£äººï¼šåç«¯å¼€å‘è€…

4. **System æ¨¡å—** (ä¼˜å…ˆçº§ï¼šä½)
   - åˆå¹¶ `update` ç­‰ç³»ç»ŸåŠŸèƒ½åˆ° `src/main/features/system/`
   - è´Ÿè´£äººï¼šå…¨æ ˆå¼€å‘è€…

### è¿ç§»æ­¥éª¤æ¨¡æ¿

æ¯ä¸ªæ¨¡å—æŒ‰ä»¥ä¸‹æ­¥éª¤è¿ç§»ï¼š

1. **åˆ›å»ºæ–°ç›®å½•**
   ```bash
   mkdir src/main/features/[module-name]
   ```

2. **è¿ç§»ä¸šåŠ¡é€»è¾‘**
   - å°† `services/[module]/index.ts` å†…å®¹è¿ç§»åˆ° `features/[module]/service.ts`
   - ç§»é™¤å•ä¾‹æ¨¡å¼ï¼Œæ”¹ä¸ºç®€å•çš„ç±»
   - ä½¿ç”¨æ–°çš„ Logger: `Logger.create('[ModuleName]Service')`

3. **è¿ç§» IPC å¤„ç†**
   - å°† `services/[module]/ipc.ts` å†…å®¹è¿ç§»åˆ° `features/[module]/ipc.ts`
   - å®ç° `IpcHandler` æ¥å£
   - ä½¿ç”¨ç»Ÿä¸€çš„äº‹ä»¶å¸¸é‡: `Events.MODULE_ACTION`

4. **åˆ›å»ºæ¨¡å—å¯¼å‡º**
   - åˆ›å»º `features/[module]/index.ts`
   - å¯¼å‡ºæœåŠ¡ç±»å’Œ IPC å¤„ç†ç±»
   - æä¾› `createModuleModule()` å·¥å‚å‡½æ•°

5. **æ›´æ–°åº”ç”¨ç®¡ç†å™¨**
   - åœ¨ `core/app.ts` ä¸­æ³¨å†Œæ–°æ¨¡å—
   - åˆ é™¤æ—§çš„å¯¼å…¥å’Œåˆå§‹åŒ–ä»£ç 

## ğŸ”§ å¼€å‘è§„èŒƒ

### æ–‡ä»¶å¤§å°æ§åˆ¶
- `service.ts`: 150-250 è¡Œ
- `ipc.ts`: 80-150 è¡Œ  
- `index.ts`: 5-15 è¡Œ

### é”™è¯¯å¤„ç†
```typescript
// ç»Ÿä¸€çš„é”™è¯¯å¤„ç†æ¨¡å¼
try {
  const result = await operation();
  this.logger.info('Operation completed');
  return result;
} catch (error) {
  this.logger.error('Operation failed:', error);
  throw new Error(`Operation failed: ${error instanceof Error ? error.message : 'Unknown error'}`);
}
```

### IPC å“åº”æ ¼å¼
```typescript
// ç»Ÿä¸€çš„ IPC å“åº”æ ¼å¼
{
  success: boolean;
  data?: T;
  error?: string;
}
```

## ğŸ‘¥ å›¢é˜Ÿåˆ†å·¥å»ºè®®

- **å¼€å‘è€…A**: window + dialog æ¨¡å—
- **å¼€å‘è€…B**: network æ¨¡å—  
- **å¼€å‘è€…C**: system æ¨¡å— + ä¸»åº”ç”¨é‡æ„
- **å¼€å‘è€…D**: æµ‹è¯• + æ–‡æ¡£

## ğŸ¯ æˆåŠŸæŒ‡æ ‡

- [ ] æ¯ä¸ªåŠŸèƒ½æ¨¡å—ç‹¬ç«‹ï¼Œæ–‡ä»¶å¤§å°åˆç†
- [ ] å›¢é˜Ÿæˆå‘˜å¯ä»¥å¹¶è¡Œå¼€å‘ï¼Œå‡å°‘å†²çª
- [ ] æ–°äººèƒ½åœ¨ 1 å¤©å†…ç†è§£æ–°ç»“æ„
- [ ] æ·»åŠ æ–°åŠŸèƒ½åªéœ€æ–°å¢æ¨¡å—ç›®å½•

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **ä¿æŒå‘åå…¼å®¹**: è¿ç§»è¿‡ç¨‹ä¸­ä¸è¦ç ´åç°æœ‰ API
2. **é€æ­¥è¿ç§»**: ä¸€æ¬¡è¿ç§»ä¸€ä¸ªæ¨¡å—ï¼Œç¡®ä¿æ¯æ­¥éƒ½èƒ½æ­£å¸¸è¿è¡Œ
3. **æµ‹è¯•éªŒè¯**: æ¯ä¸ªæ¨¡å—è¿ç§»åéƒ½è¦æµ‹è¯•åŠŸèƒ½æ­£å¸¸
4. **æ–‡æ¡£æ›´æ–°**: åŠæ—¶æ›´æ–°ç›¸å…³æ–‡æ¡£å’Œå¯¼å…¥è·¯å¾„

## ğŸ”¥ å…³é”®åŸåˆ™

- **ç®€å•ä¼˜äºå¤æ‚**: é¿å…è¿‡åº¦å·¥ç¨‹åŒ–
- **å®ç”¨ä¼˜äºå®Œç¾**: ä¸“æ³¨è§£å†³å®é™…é—®é¢˜
- **å›¢é˜Ÿåä½œ**: ç»“æ„æœåŠ¡äºå›¢é˜Ÿæ•ˆç‡
- **æ¸è¿›æ”¹è¿›**: å…è®¸åç»­æ ¹æ®éœ€è¦è°ƒæ•´ 